!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-quadtree")):"function"==typeof define&&define.amd?define(["exports","d3-quadtree"],e):e(n.d3=n.d3||{},n.d3)}(this,function(n,e){"use strict";function t(n){function t(n){return n.x+n.vx}function r(n){return n.y+n.vy}function u(n){return function(){return n}}function v(){function n(n,e,t,r,u){var v=n.data;{if(!v)return e>s||r<p||t>g||u<h;var o=i(c,0),y=i(c,1);if(v.node.index!==j){var f=v.node,d=b[f.index],l=f.x+f.vx+d[0][0],m=f.y+f.vy+d[0][1],M=f.x+f.vx+d[1][0],q=f.y+f.vy+d[1][1],A=i(d,0),_=i(d,1);if(p<=M&&l<=s&&h<=q&&m<=g){var w=[Math.min.apply(null,[l,M,p,s]),Math.max.apply(null,[l,M,p,s])],z=[Math.min.apply(null,[m,q,h,g]),Math.max.apply(null,[m,q,h,g])],C=o+A-(w[1]-w[0]),E=y+_-(z[1]-z[0]),O=C*x*(E/y),P=E*x*(C/o),k=C*x*(E/_),B=E*x*(C/A);(p+s)/2<(l+M)/2?(a.vx-=O,f.vx+=k):(a.vx+=O,f.vx-=k),(h+g)/2<(m+q)/2?(a.vy-=P,f.vy+=B):(a.vy+=P,f.vy-=B)}}}}var u,v,a,d,l,c,p,h,s,g,m=[];y.forEach(function(n,e){m.push({node:n,vx:n.vx,vy:n.vy,x:n.x+(b[e][1][0]+b[e][0][0])/2,y:n.y+(b[e][0][1]+b[e][1][1])/2}),m.push({node:n,vx:n.vx,vy:n.vy,x:n.x+b[e][0][0],y:n.y+b[e][0][1]}),m.push({node:n,vx:n.vx,vy:n.vy,x:n.x+b[e][0][0],y:n.y+b[e][1][1]}),m.push({node:n,vx:n.vx,vy:n.vy,x:n.x+b[e][1][0],y:n.y+b[e][0][1]}),m.push({node:n,vx:n.vx,vy:n.vy,x:n.x+b[e][1][0],y:n.y+b[e][1][1]})});for(var M=m.length,q=0;q<f;++q)for(v=e.quadtree(m,t,r).visitAfter(o),u=0;u<M;++u){var j=~~(u/5);a=y[j],c=b[j],d=a.x+a.vx,l=a.y+a.vy,p=d+c[0][0],h=l+c[0][1],s=d+c[1][0],g=l+c[1][1],v.visit(n)}}function o(n){if(n.data)return n.bb=b[n.data.node.index];n.bb=[[0,0],[0,0]];for(var e=0;e<4;++e)n[e]&&n[e].bb[0][0]<n.bb[0][0]&&(n.bb[0][0]=n[e].bb[0][0]),n[e]&&n[e].bb[0][1]<n.bb[0][1]&&(n.bb[0][1]=n[e].bb[0][1]),n[e]&&n[e].bb[1][0]>n.bb[1][0]&&(n.bb[1][0]=n[e].bb[1][0]),n[e]&&n[e].bb[1][1]>n.bb[1][1]&&(n.bb[1][1]=n[e].bb[1][1])}function i(n,e){return n[1][e]-n[0][e]}var y,b,x=1,f=1;return"function"!=typeof n&&(n=u(null===n?[[0,0][1]]:n)),v.initialize=function(e){var t,r=(y=e).length;for(b=new Array(r),t=0;t<r;++t)b[t]=n(y[t],t,y)},v.iterations=function(n){return arguments.length?(f=+n,v):f},v.strength=function(n){return arguments.length?(x=+n,v):x},v.bbox=function(e){return arguments.length?(n="function"==typeof e?e:u(+e),v):n},v}n.bboxCollide=t,Object.defineProperty(n,"__esModule",{value:!0})});